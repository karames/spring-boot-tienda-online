<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Registro - Tienda Online</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
</head>

<body>
    <nav>
        <a href="/">Inicio</a>
        <a href="login.html">Iniciar sesión</a>
        <a href="register.html">Registrarse</a>
    </nav>
    <h2>Crear cuenta</h2>
    <form id="register-form">
        <input type="text" id="username" placeholder="Usuario" required autocomplete="username">
        <input type="email" id="email" placeholder="Correo electrónico" required autocomplete="email">
        <input type="password" id="password" placeholder="Contraseña" required autocomplete="new-password">
        <button type="submit">Registrarse</button>
    </form>
    <div id="register-error" class="error" style="display:none"></div>
    <div id="register-success" class="success" style="display:none"></div>
    <script>
        document.getElementById('register-form').addEventListener('submit', async function (e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const res = await fetch('/auth/register', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ username, email, password })
            });
            if (res.ok) {
                document.getElementById('register-success').textContent = '¡Registro exitoso! Ahora puedes iniciar sesión.';
                document.getElementById('register-success').style.display = '';
                document.getElementById('register-error').textContent = '';
                document.getElementById('register-error').style.display = 'none';
                setTimeout(() => window.location.href = '/', 1500);
            } else {
                document.getElementById('register-error').textContent = 'No se pudo registrar. ¿Usuario o email ya existen?';
                document.getElementById('register-error').style.display = '';
                document.getElementById('register-success').textContent = '';
                document.getElementById('register-success').style.display = 'none';
            }
        });
    </script>
</body>

</html>
